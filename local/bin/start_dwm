#!/bin/sh

#
# ~/local/bin/start_dwm
#

DWMLOG="$HOME/.dwm.log"
FEHBG="$HOME/.fehbg"
BRIGHT="$HOME/.bright"
LOCKER="$HOME/.screenlocker"
OBSOCK="$(make_ob_sock)"

if [ -f "$DWMLOG" ]
then
	rm -f "$DWMLOG"
fi

if ! [ -d "$HOME/.local/.fpbin" ]
then
	gen_fpbins
fi

bright 30 > "$BRIGHT"
export OBSOCK
ln -s "$HOME/.xinitrc-suckless" "$HOME/.xinitrc"
startx

if [ -f "$FEHBG" ]
then
	rm -f "$FEHBG"
fi

if ! [ -s "$DWMLOG" ]
then
	rm -f "$DWMLOG"
else
	echo "check ${DWMLOG}"
fi

if [ -f "$BRIGHT" ]
then
	rm -f "$BRIGHT"
fi

if [ -f "$LOCKER" ]
then
	rm -f "$LOCKER"
fi

if [ -p "$OBSOCK" ]
then
	make_ob_sock destroy
	do_ob clean
	unset OBSOCK
fi

rm -f "$HOME/.xinitrc"
